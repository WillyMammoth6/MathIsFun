<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Math Zoo</title>
    <style>
        /* --- RESET & BASE STYLES --- */
        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #121212; /* Dark Theme */
            color: #ffffff;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #app {
            width: 100%;
            max-width: 600px;
            height: 100%;
            position: relative;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .hidden { display: none !important; }

        .screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            text-align: center;
            animation: fadeIn 0.5s ease-out;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-size: 3rem;
            color: #FFD700;
            text-shadow: 2px 2px 0px #d35400;
            margin-bottom: 20px;
        }
        h2 { font-size: 2rem; margin-bottom: 10px; }
        p { font-size: 1.2rem; color: #bdc3c7; }

        /* --- BUTTONS --- */
        button {
            border: none;
            outline: none;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            box-shadow: 0 4px 0 rgba(0,0,0,0.4);
            transition: transform 0.1s;
        }
        button:active { transform: translateY(4px); box-shadow: none; }

        .btn-large {
            font-size: 1.5rem;
            padding: 15px 40px;
            border-radius: 50px;
            margin: 10px;
            width: 80%;
            max-width: 300px;
        }
        .btn-easy { background-color: #2ecc71; color: white; }
        .btn-hard { background-color: #e74c3c; color: white; }
        .btn-restart { background-color: #3498db; color: white; }
        .btn-manage { background-color: #9b59b6; color: white; font-size: 1rem; padding: 10px 20px; border-radius: 12px; margin-top:15px; }

        /* --- GAMEPLAY UI --- */
        .hud {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            color: #f1c40f;
            font-weight: bold;
            background: rgba(255,255,255,0.1);
            padding: 5px 15px;
            border-radius: 15px;
        }

        .question-box {
            background-color: #2c3e50;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            width: 100%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 4px solid #34495e;
        }

        .question-text {
            font-size: 4rem;
            font-weight: bold;
            color: #ecf0f1;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 100%;
        }

        .answer-btn {
            background-color: #8e44ad;
            color: white;
            font-size: 2.5rem;
            padding: 20px;
            border-radius: 15px;
        }
        .answer-btn:active { background-color: #9b59b6; }

        .feedback-msg {
            color: #e74c3c;
            font-size: 1.5rem;
            margin-top: 20px;
            font-weight: bold;
            min-height: 1.5em;
            animation: shake 0.5s;
        }

        /* --- ANIMAL REWARD --- */
        #feedback-screen {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 100;
            background: rgba(0,0,0,0.95);
        }

        .animal-img {
            max-width: 90%;
            max-height: 55vh;
            border-radius: 20px;
            border: 5px solid #fff;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
            object-fit: cover;
            background-color: #333;
        }

        .praise-text {
            font-size: 3rem;
            color: #2ecc71;
            margin-top: 20px;
            font-weight: bold;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- DIAGNOSTIC SCREEN --- */
        #diagnostic-screen {
            overflow-y: auto;
            justify-content: flex-start;
            padding-top: 20px;
            background: #1a1a1a;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            width: 100%;
            padding: 10px;
        }

        .gallery-item {
            aspect-ratio: 1;
            width: 100%;
            background: #333;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item.good { border-color: #2ecc71; }
        .gallery-item.bad { border-color: #e74c3c; opacity: 0.3; }
        
        .status-bar {
            position: sticky;
            top: 0;
            background: #2c3e50;
            width: 100%;
            padding: 10px;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>

<div id="app">
    
    <!-- TITLE SCREEN -->
    <div id="title-screen" class="screen">
        <h1>Math Zoo 3.0 ü¶Å</h1>
        <p>Pick a difficulty to start!</p>
        <br>
        <button class="btn-large btn-easy" onclick="game.startGame('easy')">Easy üôÇ</button>
        <button class="btn-large btn-hard" onclick="game.startGame('hard')">Hard üòé</button>
        <br>
        <button class="btn-manage" onclick="game.openDiagnostics()">üîß Manage Zoo</button>
    </div>

    <!-- DIAGNOSTIC SCREEN -->
    <div id="diagnostic-screen" class="screen hidden">
        <div class="status-bar">
            <div>Working Images: <span id="diag-count" style="color:#2ecc71">0</span></div>
            <button class="btn-restart" style="padding: 5px 20px; font-size: 1rem;" onclick="game.resetToTitle()">Return to Title</button>
        </div>
        <div class="gallery-grid" id="gallery-container"></div>
    </div>

    <!-- GAME SCREEN -->
    <div id="game-screen" class="screen hidden">
        <div class="hud">Score: <span id="score-display">0</span></div>
        <div class="question-box">
            <div class="question-text" id="question-text">1 + 1 = ?</div>
        </div>
        <div class="answers-grid" id="answers-container"></div>
        
        <!-- NEW FEEDBACK MESSAGE -->
        <div id="feedback-msg" class="feedback-msg hidden">Oops, try again! üòÖ</div>

        <p style="margin-top:20px; opacity: 0.5;">Question <span id="q-count">1</span> / 10</p>
    </div>

    <!-- REWARD SCREEN -->
    <div id="feedback-screen" class="screen hidden">
        <img id="animal-display" class="animal-img" src="" alt="Cute Animal" onerror="game.handleImageError(this)">
        <div class="praise-text">Correct!</div>
    </div>

    <!-- END SCREEN -->
    <div id="end-screen" class="screen hidden">
        <h1>Great Job!</h1>
        <h2>Your Score</h2>
        <h1 style="font-size: 5rem; color: #2ecc71;" id="final-score">0</h1>
        <p>You answered 10 questions!</p>
        <br>
        <button class="btn-large btn-restart" onclick="game.resetToTitle()">Play Again üîÑ</button>
    </div>

</div>

<script>
const game = {
    maxQuestions: 10,
    score: 0,
    questionNumber: 0,
    difficulty: 'easy',
    currentQuestion: null,
    isProcessing: false,
    
    // Track if user missed the current question (for scoring purposes)
    firstAttempt: true,

    activeImages: [], 

    sourceImages: [
       // AXOLOTLS (10)
        "https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/202501_Axolotl.svg/960px-202501_Axolotl.svg.png?w=600&q=80",
        "https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Ambystoma_mexicanum_photo.jpg/960px-Ambystoma_mexicanum_photo.jpg?w=600&q=80",
        "https://wwf.ca/wp-content/uploads/2025/10/Axolotl-Getty-Images.jpg?w=600&q=80",
        "https://www.nhm.ac.uk/content/dam/nhm-www/discover/axolotl/axolotl-pink-captive-bred-two-column.jpg?w=600&q=80",
        "https://animals.sandiegozoo.org/sites/default/files/2019-09/hero-axolotl.jpg?w=600&q=80",
        "https://www.childrensaquarium.com/wp-content/uploads/2024/10/axolotls.jpg?w=600&q=80",
        "https://i.natgeofe.com/n/de94c416-6d23-45f5-9708-e8d56289268e/naturepl_01132178_16x9.jpg?w=1200&w=600&q=80",
        "https://upload.wikimedia.org/wikipedia/commons/0/00/Axolotl_ganz.jpg?w=600&q=80",
        "https://media.istockphoto.com/id/1690948716/photo/a-cute-pink-axolotl-is-smiling.jpg?s=612x612&w=0&k=20&c=_Rh7ODWOLxZrAtEISwO7nO2AyxdRu3eQW_G94Zrx5Wo=&w=600&q=80",
        "https://www.swelluk.com/media/wordpress/29b6906f93f55a1c40dbde5de6354de0.png?w=600&q=80",
        "https://cdn.mos.cms.futurecdn.net/v2/t:0,l:235,cw:1406,ch:1055,q:80,w:1406/NNJGKBsjmzVApsEE85GMJM.jpg?w=600&q=80",
        "https://lazoo.org/wp-content/uploads/2023/04/Axolotl-JP-1.jpg?w=600&q=80",
        "https://www.nhm.ac.uk/content/dam/nhm-www/discover/axolotl/axolotls-one-grey-one-pink-in-tank-full-width.jpg?w=600&q=80",
        "http://realaquatics.co.uk/cdn/shop/articles/Blog_Top_Image_43_e5b580c7-fc8c-4b5f-9856-e4845386bf4e.png?v=1740569886&w=600&q=80",
        "https://www.zoomiami.org/assets/2891/8ax.jpg?w=600&q=80",
        "https://avonturia.nl/wp-content/uploads/2023/07/Axolotl-2.png?w=600&q=80",
        "https://animals.sandiegozoo.org/sites/default/files/2019-09/axolotl02.jpg?w=600&q=80",
        "https://www.currentaffairs.org/hubfs/Imported_Blog_Media/axolotl-1024x646-1.jpg?w=600&q=80",
        "https://www.reptiles.swelluk.com/media/wordpress/33bf52886557701a3b328945d7e62430.jpg?w=600&q=80",

        // --- DOGS & PUPPIES ---
        "https://images.unsplash.com/photo-1591160690555-5debfba289f0?w=600&q=80",
        "https://images.unsplash.com/photo-1543466835-00a7907e9de1?w=600&q=80",
        "https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=600&q=80",
        "https://images.unsplash.com/photo-1588943211346-0908a1fb0b01?w=600&q=80",
        "https://images.unsplash.com/photo-1517423440428-a5a00ad493e8?w=600&q=80",
        "https://images.unsplash.com/photo-1507146426996-ef05306b995a?w=600&q=80",
        "https://images.unsplash.com/photo-1561037404-61cd46aa615b?w=600&q=80",
        "https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=600&q=80",
        "https://images.unsplash.com/photo-1552053831-71594a27632d?w=600&q=80",
        "https://images.unsplash.com/photo-1537151608828-ea2b11777ee8?w=600&q=80",

        // --- KITTENS ---
        "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=600&q=80",
        "https://images.unsplash.com/photo-1573865526739-10659fec78a5?w=600&q=80",
        "https://images.unsplash.com/photo-1533738363-b7f9aef128ce?w=600&q=80",
        "https://images.unsplash.com/photo-1513360371669-4adf3dd7dff8?w=600&q=80",
        "https://images.unsplash.com/photo-1526336024174-e58f5cdd8e13?w=600&q=80",
        "https://images.unsplash.com/photo-1519052537078-e6302a4968d4?w=600&q=80",
        "https://images.unsplash.com/photo-1501820488136-72669149e0d4?w=600&q=80",
        "https://images.unsplash.com/photo-1506755855567-92ff770e8d00?w=600&q=80",

        // --- RED PANDAS & BEARS ---
        "https://images.unsplash.com/photo-1570288685280-7802a8f8c4fa?w=600&q=80",
        "https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=600&q=80",
        "https://images.unsplash.com/photo-1501686637-b7aa9c48a882?w=600&q=80",
        "https://images.unsplash.com/photo-1526716173434-a1b560f2065d?w=600&q=80",

        // --- BUNNIES & SMALL ANIMALS ---
        "https://images.unsplash.com/photo-1555685812-4b943f1cb0eb?w=600&q=80",
        "https://images.unsplash.com/photo-1591382386627-349b692688ff?w=600&q=80",
        
        // --- FOXES ---
        "https://images.unsplash.com/photo-1516934024742-b461fba47600?w=600&q=80",
        "https://images.unsplash.com/photo-1474511320723-9a56873867b5?w=600&q=80",
        
        // --- EXTRA CUTE MIX ---
        "https://images.unsplash.com/photo-1576201836106-db1758fd1c97?w=600&q=80",
        "https://images.unsplash.com/photo-1560807707-8cc77767d783?w=600&q=80",
        "https://images.unsplash.com/photo-1534361960057-19889db9621e?w=600&q=80",
        "https://images.unsplash.com/photo-1518020382113-a7e8fc38eac9?w=600&q=80",
        "https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=600&q=80",
        "https://images.unsplash.com/photo-1601758177266-bc599de87707?w=600&q=80",
        "https://images.unsplash.com/photo-1555169062-013468b47731?w=600&q=80",

        // --- From Grok ---
        "https://images.unsplash.com/photo-1560114928-40f1f1eb26a0?w=600&q=80",
        "https://images.unsplash.com/photo-1518791841217-8f162f1e1131?w=600&q=80",
        "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=600&q=80",
        "https://images.unsplash.com/photo-1534361960057-19889db9621e?w=600&q=80",
        "https://images.unsplash.com/photo-1507146426996-ef05306b995a?w=600&q=80",
        "https://images.unsplash.com/photo-1701532420819-b6c28840ce05?w=600&q=80",
        "https://images.unsplash.com/photo-1500621242946-fc62f4875073?w=600&q=80",
        "https://images.unsplash.com/photo-1500479694472-551d1fb6258d?w=600&q=80",
        "https://images.unsplash.com/photo-1620576537654-089e6620b4ea?w=600&q=80",
        "https://images.unsplash.com/photo-1517837543704-3617ae61a835?w=600&q=80",
        "https://images.unsplash.com/photo-1726335849092-a9870a096165?w=600&q=80",
        "https://images.unsplash.com/photo-1635922511024-5ea80c617b78?w=600&q=80",
        "https://images.unsplash.com/photo-1604417389023-3018ace0afbf?w=600&q=80",
        "https://images.unsplash.com/photo-1528359645462-5ff224bf906e?w=600&q=80",
        "https://images.unsplash.com/photo-1540126034813-121bf29033d2?w=600&q=80",
        "https://images.unsplash.com/photo-1538099023053-30e7da644196?w=600&q=80",
        "https://images.unsplash.com/photo-1663869172866-7f13e4977be8?w=600&q=80",
        "https://images.unsplash.com/photo-1597953601374-1ff2d5640c85?w=600&q=80",
        "https://images.unsplash.com/photo-1712979242477-5cdd2ac07fa5?w=600&q=80",
        "https://images.unsplash.com/photo-1617398881039-4c977f633b0e?w=600&q=80",
        "https://images.unsplash.com/photo-1628067611203-a24e1cc77de5?w=600&q=80",
        "https://images.unsplash.com/photo-1591561582301-7ce6588cc286?w=600&q=80",
        "https://images.unsplash.com/photo-1538640206218-edd12e7624fc?w=600&q=80",
        "https://images.unsplash.com/photo-1533651180995-3b8dcd33e834?w=600&q=80",
        "https://images.unsplash.com/photo-1555281614-8d58d2611325?w=600&q=80",
        "https://images.unsplash.com/photo-1596376769765-3727dd84f9b5?w=600&q=80",
        "https://images.unsplash.com/photo-1635384280816-5b841263863c?w=600&q=80",
        "https://images.unsplash.com/photo-1599557180413-b3904af41411?w=600&q=80",
        "https://images.unsplash.com/photo-1568431477192-52bb13a55088?w=600&q=80",
        "https://images.unsplash.com/photo-1605369179729-4036b4d829cb?w=600&q=80",
        "https://images.unsplash.com/photo-1534278931827-8a259344abe7?w=600&q=80",
        "https://images.unsplash.com/photo-1604961838276-1b74540214c0?w=600&q=80",
        "https://images.unsplash.com/photo-1727098686140-c38eee077281?w=600&q=80",
        "https://images.unsplash.com/photo-1721833144160-1bb72d04ff4c?w=600&q=80",
        "https://images.unsplash.com/photo-1698435354379-b10bcc803369?w=600&q=80",
        "https://images.unsplash.com/photo-1722340029062-6a6f3b934c40?w=600&q=80",
        "https://images.unsplash.com/photo-1705331061640-dc2eab910b74?w=600&q=80",
        "https://images.unsplash.com/photo-1731673883639-f2b27d5cd797?w=600&q=80",
        "https://images.unsplash.com/photo-1577021121271-de79349d7191?w=600&q=80",
        "https://images.unsplash.com/photo-1577021307655-7f9785f40e2d?w=600&q=80",
        "https://images.unsplash.com/photo-1569247625012-49e746e882e1?w=600&q=80",
        "https://images.unsplash.com/photo-1532341822085-6f3386f2bfa3?w=600&q=80",
        "https://images.unsplash.com/photo-1719433203940-a9329d15d3e9?w=600&q=80",

    ],

    init: function() {
        this.activeImages = [...this.sourceImages];
    },

    startGame: function(mode) {
        this.difficulty = mode;
        this.score = 0;
        this.questionNumber = 0;
        this.isProcessing = false;
        
        document.getElementById('score-display').innerText = this.score;
        this.showScreen('game-screen');
        this.nextQuestion();
    },

    resetToTitle: function() {
        this.showScreen('title-screen');
    },

    showScreen: function(id) {
        document.querySelectorAll('.screen').forEach(el => el.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        window.scrollTo(0,0);
    },

    // --- DIAGNOSTICS & MANAGEMENT ---

    openDiagnostics: function() {
        this.showScreen('diagnostic-screen');
        const container = document.getElementById('gallery-container');
        container.innerHTML = '';
        const countDisplay = document.getElementById('diag-count');

        this.activeImages = []; 
        
        this.sourceImages.forEach((url, index) => {
            const div = document.createElement('div');
            div.className = 'gallery-item';
            
            const img = document.createElement('img');
            img.src = url;
            
            img.onload = () => {
                div.classList.add('good');
                this.activeImages.push(url);
                countDisplay.innerText = this.activeImages.length;
            };
            
            img.onerror = () => {
                div.classList.add('bad');
                img.style.display = 'none';
                div.innerHTML = '<span style="color:red; font-size:20px; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%)">‚ùå</span>';
            };

            div.appendChild(img);
            container.appendChild(div);
        });
    },

    // --- MATH LOGIC ---

    getRandomInt: function(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    },

    generateQuestion: function() {
        let n1, n2, operator, answer;
        const isAddition = Math.random() > 0.5;

        if (this.difficulty === 'easy') {
            n1 = this.getRandomInt(1, 3);
            n2 = this.getRandomInt(1, 9);
        } else {
            n1 = this.getRandomInt(1, 10);
            n2 = this.getRandomInt(1, 10);
        }

        if (isAddition) {
            operator = '+';
            answer = n1 + n2;
        } else {
            operator = '-';
            if (n2 > n1) { [n1, n2] = [n2, n1]; }
            answer = n1 - n2;
        }

        return { text: `${n1} ${operator} ${n2} = ?`, correctAnswer: answer };
    },

    generateAnswers: function(correct) {
        let answers = new Set();
        answers.add(correct);
        while (answers.size < 4) {
            let offset = this.getRandomInt(-3, 3);
            let wrong = correct + offset;
            if (wrong >= 0 && wrong !== correct) {
                answers.add(wrong);
            } else if (wrong < 0) {
                answers.add(this.getRandomInt(0, 10));
            }
        }
        return Array.from(answers).sort(() => Math.random() - 0.5);
    },

    nextQuestion: function() {
        if (this.questionNumber >= this.maxQuestions) {
            this.endGame();
            return;
        }
        this.questionNumber++;
        this.firstAttempt = true; // Reset attempt flag
        document.getElementById('feedback-msg').classList.add('hidden'); // Hide oops msg
        
        document.getElementById('q-count').innerText = this.questionNumber;
        
        this.currentQuestion = this.generateQuestion();
        const choices = this.generateAnswers(this.currentQuestion.correctAnswer);

        document.getElementById('question-text').innerText = this.currentQuestion.text;
        
        const container = document.getElementById('answers-container');
        container.innerHTML = ''; 

        choices.forEach(choice => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.innerText = choice;
            btn.onclick = () => this.checkAnswer(choice);
            container.appendChild(btn);
        });
        this.isProcessing = false;
    },

    checkAnswer: function(selectedVal) {
        if (this.isProcessing) return;

        if (selectedVal === this.currentQuestion.correctAnswer) {
            // Correct Answer!
            this.isProcessing = true; // Lock input
            
            // Only award point on first attempt
            if (this.firstAttempt) {
                this.score++;
                document.getElementById('score-display').innerText = this.score;
            }
            
            // Hide oops message just in case
            document.getElementById('feedback-msg').classList.add('hidden');
            this.showFeedback();
            
        } else {
            // Incorrect Answer
            this.firstAttempt = false; // Mark question as "dirty" (no points allowed)
            const msg = document.getElementById('feedback-msg');
            msg.classList.remove('hidden');
            
            // Re-trigger shake animation
            msg.style.animation = 'none';
            msg.offsetHeight; /* trigger reflow */
            msg.style.animation = 'shake 0.5s';
        }
    },

    showFeedback: function() {
        if (this.activeImages.length === 0) {
            this.activeImages = [...this.sourceImages]; 
        }

        const randomImg = this.activeImages[Math.floor(Math.random() * this.activeImages.length)];
        const imgEl = document.getElementById('animal-display');
        imgEl.src = "";
        imgEl.src = randomImg;
        this.showScreen('feedback-screen');

        setTimeout(() => {
            this.showScreen('game-screen');
            this.nextQuestion();
        }, 3000);
    },

    handleImageError: function(imgEl) {
        const brokenUrl = imgEl.src;
        this.activeImages = this.activeImages.filter(u => u !== brokenUrl);
        
        if (this.activeImages.length > 0) {
            const nextImg = this.activeImages[Math.floor(Math.random() * this.activeImages.length)];
            imgEl.src = nextImg;
        } else {
            imgEl.style.display = 'none';
        }
    },

    endGame: function() {
        document.getElementById('final-score').innerText = this.score;
        this.showScreen('end-screen');
    }
};

game.init();
</script>

</body>
</html>
